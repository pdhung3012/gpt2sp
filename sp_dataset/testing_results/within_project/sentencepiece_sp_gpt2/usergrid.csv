issuekey,title,description,storypoint,raw predictions
USERGRID-899,Validate migrate_entity_data script produces consistent migrations.,"Validate that https://github.com/apache/incubator-usergrid/blob/two-dot-o-dev/stack/scripts/migrate_entity_data.py produces consistent entity data migrations.     1) put data into UG build from latest in two-dot-o  2) stand up UG build from two-dot-o-dev pointing to same keyspace (different queue names) and run /system/database/setup  3) from UG running two-dot-o-dev, run migrate_entity_data.py  4) read data from UG two-dot-  4) once finished,  read entities from UG two-dot-o and UG two-dot-o-dev and ensure there is an exact match  ",1,2.9469144
USERGRID-900,Re-index using AmazonAsyncEventService should support updated date,see implemented example for InMemoryAsyncEventService    org/apache/usergrid/corepersistence/asyncevents/EventBuilderImpl.java:166    This filters out based on modified/updated date for the events to be indexed.  Need to ensure AmazonAsyncEventService consumers implement something similar OR look to have the producer filter out the events and not even drop on the AWS queues.,3,3.091653
USERGRID-901,Fix CorePersistant Properties and Stack Properties to not overlap when using Aws SDK,They both use the AWS sdk but have the possibility to use different versions. This possibility should be eliminated in the future by consolidating which sdk is pulled.,2,3.0083153
USERGRID-902,Unable to do case sensitive queries using '=',"Lets say you have two values {""name"":""cow""} and {""name"":""Cow""}  When you do a query on name = ""cow"".    We get both ""cow"" and ""Cow"" back in the results. Equals should be a case sensitive search. ergo we should only be returning ""cow""",3,2.9978826
USERGRID-903,Cannot query and return entities that end in a space.,"not being able to query and return entities which end in a space ""value ""    If I submit a value with {""name"":""value ""} then do a search on name=""value"" I do not retrieve the value. This should be checked to see if we do get the value back if we query on name=""value "". If we do then we have a couple of options. We could trim the string so people cannot have values with space on the end, or could mark as a non issue since you really want a search of contains or something similar. ""="" should be saved for equalities. ",3,2.9050972
USERGRID-904,Encodings in values are not being returned from query engine.,Values like  “%7BaccountId%7D�? are being put into usergrid but they can no longer be queried out.,3,2.934513
USERGRID-907,Batch interval in seconds not honored,The following property is present in the configuration of counter batch submits.  {code} usergrid.counter.batch.interval=30 {code}  This is not honored.  This needs fixed in the 2.0 and 2.1 branch.,3,2.9205992
USERGRID-908,run specific migration,,1,2.8377068
USERGRID-909,Evaluate removing cache from edge shard management,"Currently, using caches with the proposal phase for new shards has caused large numbers of tombstones.  Review the algorithm, and determine the cause of the additional shard proposals.    Usergrid currently performs 5 shard lookups on write and most miss the cache.  We'll change the following    *Shard allocation*    Shard allocation will not perform a propose + check phase. The following algorithm will occur.  This must occur at EACH_QUORUM to ensure that we have consensus across regions.      Any node will propose a new shard pivot.  This pivot will have compacted set to false, and will have a column timestamp of a new timeuuid in micros    The proposing node will then read back all compacted = false shard pivots.  The shard pivot with the minimum timestamp will be retained, all others will be deleted as proposals.  This will function similarly to distributed read locks in Cassandra.  Lowest proposed value always wins.     Allocation is complete    *Shard compaction*    After a successful proposal allocation, the allocating node will copy all edges from the previously compacted shard into the new shard.  It will continue to copy until no new edges are returned on read.    Once read has been completed, all edges that were copied can be deleted from the previous shard.      This target shard will be marked as compacted    *Consistency*    When performing consistency, we will need a higher consistency level.  To ensure that shards exist worldwide, proposal + selection should occur at EACH_QUORUM.  Standard reads can occur as LOCAL_QUORUM  ",5,2.881686
USERGRID-912,Upgrade Shiro to be current version,In order to support NIO.  Current version is ancient.  ,1,3.0068812
USERGRID-914,Blog post for 10k TPS and horizontal scalability,,2,2.8987136
USERGRID-918,Add qparam to skip retrieving metadata and graph edges,"If the qparam is not there, use current/default behavior.  If the qparam is there then skip pulling the extra data which will result in better performance.",8,2.9432926
USERGRID-921,Remove duplicate add to collection on write path,Todd's spaghetti comments on write path which results in 2x writes to cassandra ops.,3,3.0439782
USERGRID-926,Include distances in geoquery responses,"The best place for this would be in the metadata of the results, in metadata.distance perhaps.",3,2.8166246
USERGRID-929,Test the creation of entities which have an OldUUID to migrate from 1.0 to 2.1,,1,2.9677784
USERGRID-933,[SPIKE] Understand what remains and break up tasks for migrating properties from files on Tomcat to Org-level in the management app,,3,3.0206652
USERGRID-936,Unit Test for MapToEntityConverter.processListForField to test for 2d array and infinite loop,"  2015-08-25 00:01:10,246 [http-bio-8080-exec-313] ERROR org.apache.usergrid.rest.exceptions.AbstractExceptionMapper- org.apache.usergrid.rest.exceptions.UncaughtException Server Error (500)  org.apache.usergrid.rest.exceptions.UncaughtException: java.lang.StackOverflowError          at org.apache.usergrid.rest.exceptions.AbstractExceptionMapper.toResponse(AbstractExceptionMapper.java:59)          at org.apache.usergrid.rest.exceptions.ThrowableMapper.toResponse(ThrowableMapper.java:37)          at com.sun.jersey.spi.container.ContainerResponse.mapException(ContainerResponse.java:480)          at com.sun.jersey.spi.container.ContainerResponse.mapMappableContainerException(ContainerResponse.java:417)          at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1477)          at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1419)          at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1409)          at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409)          at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558)          at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:927)          at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:875)          at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:829)          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)          at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)          at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)          at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)          at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)          at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)          at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)          at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)          at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:343)          at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:260)          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)          at org.apache.usergrid.rest.filters.ContentTypeFilter.doFilter(ContentTypeFilter.java:92)          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)          at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)          at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)          at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)          at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)          at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)          at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)          at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)          at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)          at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)          at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)          at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:314)          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)          at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)          at java.lang.Thread.run(Thread.java:745)  Caused by: java.lang.StackOverflowError          at org.apache.usergrid.persistence.model.entity.MapToEntityConverter.processListForField(MapToEntityConverter.java:148)          at org.apache.usergrid.persistence.model.entity.MapToEntityConverter.processListForField(MapToEntityConverter.java:148)          at org.apache.usergrid.persistence.model.entity.MapToEntityConverter.processListForField(MapToEntityConverter.java:148)          at org.apache.usergrid.persistence.model.entity.MapToEntityConverter.processListForField(MapToEntityConverter.java:148)          at org.apache.usergrid.persistence.model.entity.MapToEntityConverter.processListForField(MapToEntityConverter.java:148)",1,2.9052422
USERGRID-937,Nested Arrays in documents result in infinite loop / stack overflow,"Need to investigate and decide on an approach.  In addition, do we support arrays with elements of varying types?      org.apache.usergrid.persistence.model.entity.MapToEntityConverter.processListForField(MapToEntityConverter.java:148)",1,2.8820574
USERGRID-938,Create a tool with the capability to wipe an application from Cassandra,"Given an App ID, we need to be able to wipe the data from Cassandra.  This can be standalone.",3,3.0046158
USERGRID-939,Style generated Docs like the Website,"Currently our Sphinx-generated docs adopt the look and feel of the ReadTheDocs website, which is not bad but it does not look like the rest of our website.     We should style the docs so that the use the same header and footer as our existing website and use the same colors, fonts, etc.",3,2.949092
USERGRID-940,Generated docs should include Client SDK docs,"The generated docs should include our existing Client SDK docs, which already exist in Markdown format within the Usergrid Git repo.",3,2.904356
USERGRID-941,Spike: Investigate using Java Annotations to generate Swagger,,5,2.928781
USERGRID-944,Prototype using Spark to perform functions on data in Cassandra,As we discussed we'd like to see about using Spark for things such as: 1) migrating orgs from one keyspace to another 2) deleting all records for an app from Cassandra,3,2.8893812
USERGRID-945,Perform load testing of new shard management impl,"We'll want to load test this with our existing entity writes during heavy load.  We need to ensure shard allocation can keep up, and that we have a consistent view of the shards.  We need to test the following scenarios    # Write over 10 million entities in a single collection, single region only  # Write over 10 million entities concurrently in 2 regions  # Write over 10 million entities concurrently in 2 regions, and fail 1 of the regions.  The system should still function, just not allocate new shards.    ",5,2.973083
USERGRID-950,Remove Cassandra Keyspace name from Index Naming Strategy,,1,2.961508
USERGRID-989,Create a multi region lock ability for shard allocation,"With the new shard proposal algorithm, we need the ability to either   1)  Perform routing aware shard allocation across multi regions.  This ensures that we ",5,3.0799162
USERGRID-991,Fix tests after Jersey 2.0 upgrade,,5,2.8572469
USERGRID-992,Enable Org-level properties,,5,2.7772298
USERGRID-993,Separate database system and system bootstrap,"A call to /system/database/setup currently performs a database setup, ES setup, and then proceeds to migrate data.  This should be split into 2 separate events.  They should be the following.   /system/database/setup creates all column families and ES indexes  /system/database/bootstrap  runs a datamigration manager, then  creates all bootstrap data required for usergrid to function",3,2.7387137
USERGRID-1000,get apm/apigeeMobileConfig throws exception when its not set,"2015-09-04 22:34:01,420 [http-bio-8080-exec-22] ERROR org.apache.usergrid.rest.exceptions.AbstractExceptionMapper- Uncaught Exception  java.lang.IllegalArgumentException: JSON source MUST not be null          at com.sun.jersey.api.json.JSONWithPadding.<init>(JSONWithPadding.java:90)          at org.apache.usergrid.rest.applications.ApplicationResource.getAPMConfig(ApplicationResource.java:613)          at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)          at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)          at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)          at java.lang.reflect.Method.invoke(Method.java:483)          at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)          at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$TypeOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:185)          at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)          at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:302)          at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)          at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:137)          at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)          at com.sun.jersey.server.impl.uri.rules.SubLocatorRule.accept(SubLocatorRule.java:137)          at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)          at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)          at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)          at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)          at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1542)          at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1473)          at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1419)          at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1409)          at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:409)          at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:558)          at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:927)          at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:875)          at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:829)          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)          at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)          at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)          at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)          at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)          at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:383)          at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)          at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)          at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:343)          at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:260)          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)          at org.apache.usergrid.rest.filters.ContentTypeFilter.doFilter(ContentTypeFilter.java:92)          at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)          at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)          at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)          at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)          at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:503)          at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)          at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)          at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)          at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)          at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)          at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1070)          at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)          at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:314)          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)          at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)",3,3.045468
USERGRID-1005,Add Background processing for delete application,,2,2.7920237
USERGRID-1007,Implement a cache for Shiro & permissions,"How will a cache help improve performance?  * Reduce load on Tomcat, ES and C* caused by permissons calculation.              Do we need a distributed cache?  * YES: Todd says we tried non-distributed cache (w/EhCache) and the caching was not effective (bad hit/mss ratio).    Implementation ideas:  * Use Cassandra column family implementation   * Use Hazelcast cache  * Use EhCache configured for distributed operation    How much should we expect performance to improve? How can we test this?  * JUnit + metrics collection in our cache implementation    Simplest approach seems to be Cassandra. Here's a design:    h1. Add new Core Persistence Cache module    This is a new module that depends only on the Core Persistence Common module (and maybe Model?) and provides a generic cache interface that is ""segmented"" by a cache scope. When you put or get things you specify the cache scope, and it is possible to invalidate all things within a cache scope with one call.    {code}  public interface SegmentedCache<K,V> {       /** Put value into segment with ttl */     void put( CacheScope scope, K key, V value, long ttl );       /** Get value from segment */     V get( CacheScope segment, K key );       /** Delete all cache data of all types and of all scopes */     void invalidate();       /** Delete all cache data within specified segment */     void invalidate( CacheScope segment );  }  {code}    Caches are stored in Cassandra *Usergrid_Cache* column family:  * Row-key is applicationId  * Column key is toString() of K key  * Value is serialized V value object    h1. Plugin our Cache into Shiro at the REST module level    To plugin to Shiro, we provide implementations of the Shiro *CacheManager* and *Cache* interfaces that are backed by the Cache module.     When permissions are updated, we need need to ensure that the old cached permissions are invalidated. So we will modify the *EntityManager* revoke and grant methods to call invalidate for the application's cache scope.    ",5,2.866944
USERGRID-1013,Automate upload of api baas 2.1 build to s3,,3,2.948229
USERGRID-1015,Test Notification Migration ,,3,2.6839318
USERGRID-1016,Remove UUID field encoding in our ES fields,"We shouldn't encode a UUID as a specific UUID field type, since we're encoding it as a string.  To keep our index tuples simple, and support both queries, we should store it as a string type.  We should support the following formats.  {code} select * where myUuid = 'aaa65d8a-16a6-11e5-86ea-7b4f7ff44431' {code}  As well as   {code} select * where myUuid = aaa65d8a-16a6-11e5-86ea-7b4f7ff44431 {code}  Notice the addition of single quotes in the first query, vs the parsing as a UUID type in the second query.  This will enable users to use both versions, but does not affect performance. ",3,2.7913878
USERGRID-1017,Create a job to clean unused edges,"We need a system job that audits edges and ensures they point to an entity.  If not, the edge should be removed.",3,2.94705
USERGRID-1018,Create a job to remove duplicate connections and fix connection write logic,"A bug in 2.0 has led to multiple edges on a connection.  We need a job that scans all connections, and keeps the lowest timestamp on the connection.  Other edges should be deleted. ",3,3.0833113
USERGRID-1022,remove batching in index processing,,1,2.8262172
USERGRID-1023,Delete from collection does not use SQS or the event service,,3,3.0354166
USERGRID-1024,Fix EntityMapSerialization in EntityToMapConverter to remove type serialization,EntityToMapConverter line 143 injects binary objects into our serialized maps.  Probably a good idea to change this to just map structures instead.  we want to remove the type info. see attached,3,3.0065885
USERGRID-1026,Logic to detect (N+1)-d arrays catches a case where there is no 2-d array,"This entity is not fully indexed with the error message below.  It does not have a (direct) 2-d array.  It does have nested arrays, however.    2015-09-18 03:20:28,190 [Usergrid-RxIOPool-151] WARN  org.apache.usergrid.persistence.index.impl.EntityMappingParser- Encountered 2 collections consecutively.  N+1 dimensional arrays are unsupported, only arrays of depth 1 are supported  {     ""type"" : ""example"",     ""name"" : ""8980031"",     ""created"" : 1442527975706,     ""modified"" : 1442547269098,     ""FacilityName"" : ""ALICES RESTAURANT"",     ""LastUpdateOn"" : ""9/17/2015"",     ""Locations"" : [ {       ""Addresses"" : [ {         ""Zip"" : ""94062"",         ""AddressLine1"" : ""17288 Skyline Blvd"",         ""LatNbr"" : ""37.386916"",         ""LongNbr"" : ""-122.265383"",         ""State"" : ""CA"",         ""AddrUseCd"" : ""PH"",         ""City"" : ""WOODSIDE""       } ],       ""Phones"" : [ {         ""PhnUseCd"" : ""PH"",         ""PhoneNbr"" : ""123-456-3534""       } ],       ""LocSeq"" : ""1"",       ""PracLocStrtDt"" : ""1/1/9999"",       ""PracLocEndDt"" : ""3/31/9999"",       ""Accepting"" : false,       ""PracLocSpecialties"" : [ {         ""SpcltyPrimInd"" : ""Y"",         ""SpcltyDsc"" : ""PANCAKES"",         ""SpcltyCd"" : ""BRKF""       } ]     } ],     ""TheId"" : 8980031,     ""ProviderType"" : ""FAC"",     ""PvdrEndDt"" : ""3/31/2008"",     ""PvdrSpecialties"" : [ {       ""SpcltyPrimInd"" : ""Y"",       ""SpcltyDsc"" : ""PANCAKES"",       ""SpcltyCd"" : ""BRKF""     } ]   }",1,3.022242
USERGRID-1027,Occational MIsses on Indexing into Elasticsearch,Occasionally applications still aren't being indexed into elasticsearch. Need to investigate why these might be occuring. ,8,2.967176
USERGRID-1029,"When PUTing by uuid or name, add the entry into entity_id_sets column family","When a PUT occurs in 1.0, then entry to Entity_Id_Sets is not re-inserted.  We need to ensure it is re-written. ",3,3.0652678
USERGRID-1031,Test and confirm Usergrid 1.0 works with Cassandra 2.1,1) Test locally 2) Confirm in e2e ,2,2.8211575
USERGRID-1032,Test and confirm Usergrid 2.1 works with Cassandra 2.1,,2,2.83752
USERGRID-1033,Test and confirm Usergrid 2.0 works with Cassandra 2.1,,1,2.8323808
USERGRID-1035,Fix NoAwsCreds rule to work outside of core. ,The no aws creds rule call doesn't work outside of core. It fails in service and rest when using the one based in core. ,2,2.924822
USERGRID-1037,Refactor asset aws sdk class,Refactor the class so that it doesn't need to retrieve the s3 client everytime. also we need to use the usergrid credentials class so that we can match how we connect to sqs. That way the code is more consistent. ,2,2.917425
USERGRID-1038,2.1-release: fix index batching from SQS reader,,3,2.99614
USERGRID-1046,remove index and deindex requests that do not go through sqs e.g. CandidateIdFilter,move all these requests to sqs.  any piece of code that calls indexproducer.put() has to be changed to call the index service and call to ES asynchronously through sqs ,3,3.06599
USERGRID-1048,When reading messages from SQS an elevated consistency may be needed with latent replication,"Occasionally Cassandra multi-region replication lags during high load.  During this high load, messages fail to process because it cannot read the entity from Cassandra.  Rather than fail, we should retry with a high consistency level of quorum in all regions to ensure we replicate the data correctly. ",3,3.0044608
USERGRID-1051,When ElasticSearch rejects a Search request Usergrid should not return 200 OK with an empty array,Currently if the search queue is full a 200 response is returned with an empty entity array.,1,2.883602
USERGRID-1052,"After large deletions, graph seek time becomes slow","After a large number of deletions, 100k +, seek time on graph becomes very slow when searching collections.  Identify the issue, and implement a fix based off of sha  a09485a3a5ac8b4217b294f4754ea8a70a7ec447 ",5,3.0348918
USERGRID-1053,[SPIKE] Audit TODOs in the code,We need to audit the TODO statements in the code.  For each we must:    1) Check if there is an existing ticket  - If there is no ticket create one  2) Update the TODO statement with the link to the ticket  3) Prioritize based on:  - Will this generate a P1 case with a customer?  - What is the usability impact of the product?    Once we have audited these we will prioritize and schedule fixes,5,2.9887016
USERGRID-1058,Ability to generate a master Jacoco coverage report,"In addition to separate Jacoco reports for each module, we should also be able to generate a master Jacoco report.",3,2.9979053
USERGRID-1067,Finish 2.1 release testing,"We need to test the following issues to verify they've been fixed.  Multi region writes and index syncing  Multi region mass collection deletes: Delete the entire collection, then ensure that seek times are fast with no query language. ",3,2.8717773
USERGRID-1068,Create a per app migration script,"Create a python script that will allow users to upgrade from 2.0 to 2.1 per application.  This will ultimately allow an incremental deployment across an existing 2.0 cluster, without user impact.      Template for full system script that already exists: https://github.com/apache/usergrid/blob/2.1-release/stack/scripts/migrate_entity_data.py    It should allow for the following migration process:    tenant 1  1) setup new 2.1 tomcat  2) run migration bootstrap  3) migrate appinfo  4) reindex mgmt app only  5) run de-dup for whatever APP  6) reindex whatever APP  7) add 2.1 tomcats to customer ELB after 1-6 completed for all customer apps  8) run delta re-index/migration for all customer apps      tenant 2  1) reset appinfo version  2) migrate app info  3) reindex mgmt app  4) run de-dup for whatever APP  5) reindex whatever app  7) add 2.1 tomcats to customer ELB after 1-6 completed for all customer apps  8) run delta re-index/migration for all customer apps      after all apps migration  1) migrate entity data    ",2,3.0296655
USERGRID-1069,implement build metrics in jenkins,,1,2.659834
USERGRID-1071,Test iOS push notifications,,1,2.8745267
USERGRID-1072,Test Android push notifications,,1,2.855247
USERGRID-1073,Test Windows phone,,1,2.6940422
USERGRID-1074,[SPIKE] Evaluate read repair of unique values in 1.0,,1,2.8955042
USERGRID-1075,Create Repair Tool to address Service Resource Exceptions from users who cannot be queried for their data,Find a way to resolve the state where a user may still have an entity ref but is not able to be queried or retrieved without uuid.,5,3.0251288
USERGRID-1076,Create a Repair tool that will address null pointer exceptions on entity returns and then properly handle them,500 null pointer exceptions return when data is present in an entity reference but not returned from cassandra while this may be a data consistency issue an investigation needs to be done. That said in the mean time a tool should be created that either can retrieve the data and restore it ( update ) or to delete the left over entity reference. ,5,3.0639148
USERGRID-1077,Create a repair task in usergrid to handle instances of multiple INDEXES when they are detected,"Things that need to be addressed when they are found.    EntityManagerImpl.java line 1135                    if ( properties == null ) {                      logger.error( ""Error deserializing entity with key {} entity probaby doesn't exist, where did this key come from?"", key );                      continue;                  }                    UUID id = uuid( properties.get( PROPERTY_UUID ) );                  String type = string( properties.get( PROPERTY_TYPE ) );                    if ( ( id == null ) || ( type == null ) ) {                      logger.error( ""Error retrieving entity with key {}, no type or id deseriazable, where did this key come from?"", key );                      continue;                  }      Then in EntityManagerImpl getUUIDsForUniqueProperty              //shouldn't happen, but it's an error case          if ( cols.size() > 1 ) {              logger.error( ""INDEX CORRUPTION: More than 1 unique value exists for entities in ownerId {} of type {} on ""                      + ""property {} with value {}"",                      new Object[] { ownerEntityId, collectionNameInternal, propertyName, propertyValue } );          }    ^ Need to address both issues on read repair path such that we no longer need to worry about users seeing them.     For the second issue we should be able to just call delete UniqueProperty with the entity unique value in question. Just make this happen in the backend. ",8,2.9993944
USERGRID-1079,Add 2 endpoints for password hash migration,"It is currently possible to migrate from a 1.0 installation to a 2.1 installation via a RESTful client.  However, due to the inability to securely move password hashes, application user's passwords are not retained.   Add the following.  # In the 1.x branch, add the ability to retrieve the password hash.   This should only be allowed by the superuser.  # In 2.1-release, add the ability to write the password hash to an application user.  This should only be allowed by the superuser.   Note that the reason this is only allowed as a superuser is that we want to disable this functionality by default.  Any UG installation that is public facing should not have superuser enable.  This allows us to disable this functionality in environments that are publicly available environments.  ",5,2.8611698
USERGRID-1085,Create RPM Distributable for Usergrid 2.1,,5,2.9364111
USERGRID-1086,Errors/Failed index events during mgmt app re-index,"These errors/failed index events do not seem to cause any operating issues with Usergrid, but cause messages to fall into dead letter queue and increase in ERROR log statements.        2015-10-30 22:31:48,552 [Usergrid-RxIOPool-152] ERROR org.apache.usergrid.corepersistence.asyncevents.AmazonAsyncEventService- Received empty index sequence message:(6c53a75c-6351-4f2b-8e86-e0176c0bebcd), body:({""edgeIndexEvent"":{""creationTime"":1446244308487,""sourceRegion"":""us-east-1"",""applicationScope"":{""application"":{""uuid"":""b6768a08-b5d5-11e3-a495-11ddb1de66c8"",""type"":""application""}},""entityId"":{""uuid"":""b6768a08-b5d5-11e3-a495-11ddb1de66c8"",""type"":""org_application""},""edge"":{""sourceNode"":{""uuid"":""b6768a08-b5d5-11e3-a495-11ddb1de66c8"",""type"":""application""},""type"":""zzzcollzzz|org_applications"",""targetNode"":{""uuid"":""b6768a08-b5d5-11e3-a495-11ddb1de66c8"",""type"":""org_application""},""timestamp"":136655371084730107}}})  2015-10-30 22:31:48,553 [Usergrid-RxIOPool-152] ERROR org.apache.usergrid.corepersistence.asyncevents.AmazonAsyncEventService- Failed to index message: 6c53a75c-6351-4f2b-8e86-e0176c0bebcd  java.lang.Exception: Received empty index sequence.          at org.apache.usergrid.corepersistence.asyncevents.AmazonAsyncEventService.lambda$callEventHandlers$21(AmazonAsyncEventService.java:357)          at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)          at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374)          at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)          at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)          at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)          at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)          at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)          at org.apache.usergrid.corepersistence.asyncevents.AmazonAsyncEventService.callEventHandlers(AmazonAsyncEventService.java:372)          at org.apache.usergrid.corepersistence.asyncevents.AmazonAsyncEventService.lambda$null$23(AmazonAsyncEventService.java:695)          at rx.internal.operators.OperatorMap$1.onNext(OperatorMap.java:55)          at rx.internal.util.ScalarSynchronousObservable$1.call(ScalarSynchronousObservable.java:46)          at rx.internal.util.ScalarSynchronousObservable$1.call(ScalarSynchronousObservable.java:35)          at rx.Observable$2.call(Observable.java:162)          at rx.Observable$2.call(Observable.java:154)          at rx.Observable.unsafeSubscribe(Observable.java:7710)          at rx.internal.operators.OperatorSubscribeOn$1$1.call(OperatorSubscribeOn.java:62)          at rx.internal.schedulers.ScheduledAction.run(ScheduledAction.java:55)          at rx.schedulers.ExecutorScheduler$ExecutorSchedulerWorker.run(ExecutorScheduler.java:98)          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)          at java.lang.Thread.run(Thread.java:745)",3,2.9790483
USERGRID-1091,AbstractReadGraphFilter produces and queues empty queue operations,"When read repair is triggered, it is possible that there are now deIndexRequests to be queued.  Currently we're queueing empty operations and need to filter this properly.",1,2.762528
USERGRID-1092,Test and design for ElasticSearch running on Tomcat nodes,This can become a coordination task with other teams as well as executing it ourselves - for example with Kris Bhandare,5,2.7223837
USERGRID-1093,Load test in-memory queue with current consumer and queue implementation,,3,2.936022
USERGRID-1099,Order of operations error in Query Execution,  I have a test that shows that queries of this form work:  C = c and ( A > a or B = false )    But the very same query formed like this will not work properly:  ( A > a or B = false ) and C = c    ,5,2.790912
USERGRID-1100,POST /users/{user}/devices/notifications does not work.,,1,3.0150917
USERGRID-1101,Unique Value Cleanup in 2.1 - cleaning up old columns for old versions,Ensure code makes it in to prevent wide rows in unique_values CF due to old versions not getting cleaned up ,3,3.030625
USERGRID-1106,Fix test: clientCredentialsFlowWithHeaderAuthorization(),Currently this test is ignored in Usergrid master branch:  ApplicationResourceIT.clientCredentialsFlowWithHeaderAuthorization()    If it is still relevant we should fix it and un-ignore it.,3,2.9690344
USERGRID-1113,Improve NotificationsService test coverage,"Currently many of the NotificationsServiceIT and NotifiersServiceIT test are either broken or incomplete because we were unable to create the mocks we need to test the code. We should revisit this and figure out how to get better test coverage for notifications in general.    Search the code for USERGRID-1113 to find the tests that should be unignored, fixed, replace or deleted.",2,2.7718415
USERGRID-1115,Fix AdminUsersIT tests,Six of the AdminUsersIT tests are ignored because they interfere with other tests and other reasons.  Figure out how to run those tests serially or some other way to test admin user features.,5,2.8785048
USERGRID-1118,Fix EventsResource and IT,The EventsResource was broken during two-dot-o development and the tests in EventsResourceIT were marked ignore.    Fix the EventsResource and re-enable the tests.,3,2.7361917
USERGRID-1119,Fix GroupResourceIT.postGroupActivity() test,,3,2.9613547
USERGRID-1124,"Internal ""size"" within entity metadata is not displayed when doing a GET by entity name ","This request does not come back with size in metadata object.     GET /org/app/collection/entityName  {code}  {    ""action"" : ""get"",    ""application"" : ""ec2df3b3-6e0e-11e5-9798-0223e9015bf9"",    ""params"" : { },    ""path"" : ""/regions"",    ""uri"" : ""https://testing"",    ""entities"" : [ {      ""uuid"" : ""2dcf254c-8ef5-11e5-87c2-069a7df27e87"",      ""type"" : ""region"",      ""name"" : ""region6"",      ""created"" : 1447961939135,      ""modified"" : 1447961939135,      ""metadata"" : {        ""path"" : ""/regions/2dcf254c-8ef5-11e5-87c2-069a7df27e87""      }    } ],    ""timestamp"" : 1447976782774,    ""duration"" : 77,    ""organization"" : ""org"",    ""applicationName"" : ""app""  }  {code}    However, get with the entity's UUID does return the metadata size.    GET /org/app/collection/2dcf254c-8ef5-11e5-87c2-069a7df27e87  {code}  {    ""action"" : ""get"",    ""application"" : ""ec2df3b3-6e0e-11e5-9798-0223e9015bf9"",    ""params"" : { },    ""path"" : ""/regions"",    ""uri"" : ""https://testing"",    ""entities"" : [ {      ""uuid"" : ""2dcf254c-8ef5-11e5-87c2-069a7df27e87"",      ""type"" : ""region"",      ""name"" : ""region6"",      ""created"" : 1447961939135,      ""modified"" : 1447961939135,      ""metadata"" : {        ""path"" : ""/regions/2dcf254c-8ef5-11e5-87c2-069a7df27e87"",        ""size"" : 334      }    } ],    ""timestamp"" : 1447977010952,    ""duration"" : 36,    ""organization"" : ""org"",    ""applicationName"" : ""app""  }  {code}",1,3.235669
USERGRID-1182,Support GCM 3.0 for Android Push Notifications,,2,2.8709207
USERGRID-1183,Support APNS VoIP Push Notifications,"Includes supporting an additional certificate type VoIP Services Certificate.  Also we should enhance cert upload validation, etc. when creating notifiers in Usergrid.",2,2.909393
USERGRID-1186,Add DELETE for Admin Users,- Will need superuser credentials.  - Will delete admin user.  - Will remove all connections from said admin user. ( might automatically be done. needs verifying. )   -Verify can be recreated  ,2,2.8124826
USERGRID-1187,Ensure that PUT or POST does not create duplicate org association connections. ,"Doing PUT creates a duplicate edge on /management/orgs/org/users/email    for existing users who were already on the org, the POST command to /management/orgs/org/users/email creates a duplicate edge  ",2,3.0192556
USERGRID-1191,Create 2.1 Release for Apache,We need to create a 2.1 release for Apache.  Would be nice to have a binary WAR distribution.,3,2.879988
USERGRID-1203,Allow certs in notifiers to be updated and store their details in the entity.,,1,2.9713614
USERGRID-1209,GET on missing Asset file in S3 generates 500 error not 404,,1,3.0173802
USERGRID-1210,Fix AwsAssetResourceIT,Fix all the broken asset tests,3,2.7331743
USERGRID-1211,Migrate locks from Hector to Astyanax,Implement locks and a lock manager using Astyanax driver.,3,2.799549
USERGRID-1238,Error occuring when clicking link to activate organization,"Getting an email when trying to activate an organization:  {""error"":""unauthorized"",""timestamp"":1405399644281,""duration"":0,""exception"":""org.apache.usergrid.rest.exceptions.SecurityException"",""error_description"":""No organization access authorized""}  Steps to reproduce - sign up for an account, then click activation link in email that goes to sys admin    When the link is clicked then the following message pops up. Ideally it should be a rest response that denotes show the activation was successful.",3,2.924356
USERGRID-1239,Add smtp message-id to logs,Add message-id to the smtp logs.    http://stackoverflow.com/questions/5555119/sending-email-using-smtp-and-setting-the-message-id    This will help us track whether usergrid is failing to send registration email or if it is the mail service. There also needs to be additional logging enabled to track what stages the emails goes through if it is needed.,3,3.0952601
USERGRID-1244,Upgrade pushy library to use latest version (HTTP/2 APNS implementation) ,"Additional system requirements will need to be met (https://github.com/relayrides/pushy#system-requirements):    1) require openssl to be installed on servers running Usergrid and have specific compiled versions of usergrid for the supported platforms for running Usergrid (os version, etc.).  http://netty.io/wiki/forked-tomcat-native.html    2) require an additional jar file added to the boot classpath of the jvm (alpn-boot) which is specific to the JDK version being used    It may make sense to see about having the ability to disable push so that no push notification services are bootstrapped in the event someone wants to use Usergrid but does not require push and does not want to manage these additional system requirements.    Option 1 preferred at the moment as having OpenSSL installed is an easy requirement and and the platform configurations for http://netty.io/wiki/forked-tomcat-native.html seem limited.",2,3.0660837
USERGRID-1256,Introduce Datastax Java Driver in effort to migration away from Astyanax,,1,2.8950195
USERGRID-1267,Simplify Central SSO: eliminate ext token validation end-point,"Instead of requiring that clients first validate tokens obtained from an external ""Central SSO"" system, when Usergrid is configured for using Central SSO, it should attempt to verify any unknown token itself.    This can be implemented by moving the validate external token logic from the ManagementResource and into the TokenService.",3,2.931602
USERGRID-1268,Proof of Concept: use Akka for Unique Value enforcement,"By using an distributed Actor System, we can ensure that only one thread accesses any one unique value at a time. I have a working proof of concept of this that writes to Cassandra (via Java Native Driver).    Initial design is here:  https://docs.google.com/document/d/1o9okFgNb_c1RY0eIcZMhijhxE9v7BxHYDiuI8BqkLgU/edit#    Proof of Concept (POC) code is here:  https://github.com/snoopdave/akka_poc1    Presentation that explains the POC is here:  https://docs.google.com/presentation/d/11ARSPZ6IAxOYSTo4jcmEdnzXvOgVGNGslznmVtLOZjY/edit?usp=sharing  ",8,3.0423646
USERGRID-1272,Set a property to turn off usergrid's dependency on elasticsearch,"Have a property that can tell Usergrid whether we want to use elasticsearch or not. If we don't we shouldn't have any errors, should just work as is with only graph searches . ",5,2.8325536
USERGRID-1275,Allow usergrid.api.url.base to be set when creating organizations.,Allowing usergrid.api.url.base this field to be set or set differently so it is not forgotten when you are running usergrid. ,2,2.9990005
